"use strict";const Q=require("@codemirror/state"),t=require("@lezer/highlight"),u=require("markedit-api"),R=require("@codemirror/view"),k=require("@codemirror/language"),b=(a,c={})=>a??c,X=b(u.MarkEdit.userSettings),M=b(X["extension.markeditTheming"]),Y=M.enabledMode??"both",H=b(M.lightTheme),O=b(M.darkTheme),j=a=>["both",a?"dark":"light"].includes(Y),Z=I(H),tt=I(O,{dark:!0});function et(a,c){if(!j(a))return c;const r=a?tt:Z;return r===void 0?c:[r,c].filter(o=>o!==void 0)}function ot(a,c){if(!j(a))return c;const r=a?O.custom:H.custom;return r===void 0?c:{...c,...r}}function I(a,c){const r={},o=[],n=a.editor,e=a.highlight;return n?.textColor&&(r["&"]??={},r["&"].color=n?.textColor,r[".cm-activeLineGutter"]={backgroundColor:n?.textColor}),n?.backgroundColor&&(r["&"]??={},r["&"].backgroundColor=n?.backgroundColor),n?.activeLineBackground&&(r[".cm-activeLine"]={backgroundColor:n?.activeLineBackground}),n?.caretColor&&(r[".cm-content"]={caretColor:n?.caretColor},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:n?.caretColor}),n?.selectionBackground&&(r["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:n?.selectionBackground}),n?.matchingBracketBackground&&(r["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:n?.matchingBracketBackground}),n?.gutterText&&(r[".cm-gutters"]??={},r[".cm-gutters"].color=n?.gutterText),n?.gutterBackground&&(r[".cm-gutters"]??={},r[".cm-gutters"].backgroundColor=n?.gutterBackground,r[".cm-gutters"].border="none"),n?.foldPlaceholderText&&(r[".cm-foldPlaceholder"]??={},r[".cm-foldPlaceholder"].color=n?.foldPlaceholderText),n?.foldPlaceholderBackground&&(r[".cm-foldPlaceholder"]??={},r[".cm-foldPlaceholder"].backgroundColor=n?.foldPlaceholderBackground,r[".cm-foldPlaceholder"].border="none"),n?.searchMatchBackground&&(r[".cm-searchMatch"]={backgroundColor:n?.searchMatchBackground}),n?.selectionMatchBackground&&(r[".cm-selectionMatch"]={backgroundColor:n?.selectionMatchBackground}),e?.heading&&o.push({tag:t.tags.heading,color:e?.heading}),e?.bold&&o.push({tag:t.tags.strong,color:e?.bold}),e?.italic&&o.push({tag:t.tags.emphasis,color:e?.italic}),e?.strikethrough&&o.push({tag:t.tags.strikethrough,color:e?.strikethrough}),e?.quote&&o.push({tag:t.tags.quote,color:e?.quote}),e?.link&&o.push({tag:t.tags.link,color:e?.link}),e?.separator&&o.push({tag:[t.tags.definition(t.tags.name),t.tags.separator,t.tags.contentSeparator],color:e?.separator}),e?.comment&&o.push({tag:[t.tags.meta,t.tags.comment],color:e?.comment}),e?.meta&&o.push({tag:t.tags.meta,color:e?.meta}),e?.keyword&&o.push({tag:t.tags.keyword,color:e?.keyword}),e?.atom&&o.push({tag:[t.tags.atom,t.tags.bool,t.tags.url,t.tags.contentSeparator,t.tags.labelName],color:e?.atom}),e?.literal&&o.push({tag:[t.tags.literal,t.tags.inserted],color:e?.literal}),e?.string&&o.push({tag:[t.tags.string,t.tags.deleted],color:e?.string}),e?.special&&o.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:e?.special}),e?.variable&&o.push({tag:t.tags.definition(t.tags.variableName),color:e?.variable}),e?.local&&o.push({tag:t.tags.local(t.tags.variableName),color:e?.local}),e?.type&&o.push({tag:[t.tags.typeName,t.tags.namespace],color:e?.type}),e?.class&&o.push({tag:t.tags.className,color:e?.class}),e?.macro&&o.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:e?.macro}),e?.property&&o.push({tag:t.tags.definition(t.tags.propertyName),color:e?.property}),e?.label&&o.push({tag:t.tags.labelName,color:e?.label}),e?.operator&&o.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:e?.operator}),e?.constant&&o.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:e?.constant}),e?.instruction&&o.push({tag:t.tags.processingInstruction,color:e?.instruction}),e?.invalid&&o.push({tag:t.tags.invalid,color:e?.invalid}),[R.EditorView.theme(r,c),k.syntaxHighlighting(k.HighlightStyle.define(o))]}const s={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},rt=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${s.lineGutter} {}
${s.foldGutter} {}
${s.visibleSpace} {}
${s.matchingBracket} {}
${s.activeIndicator} {}
${s.emphasisElement} {}
${s.accentColor} {}
${s.syntaxMarker} {}
`,V=window,at=V.__extractStyleRules__??(a=>a.value?.rules),ct=V.__extractHighlightSpecs__??(a=>a.value?.specs);function nt(a){const c=document.createElement("style");return c.textContent=a,document.head.appendChild(c),c}function st(a){if(a===void 0)return[{},[]];const c=lt(a);return[Object.fromEntries(c.flatMap(o=>{const n=at(o)?.join(`
`)??"";return Object.entries(gt(n))})),c.flatMap(o=>ct(o)??[])]}function P(a,c){return a.find(r=>!!(r.tag.toString().includes(c.toString())&&r.color!==void 0))?.color}function v(a,c,r){for(const[o,n]of Object.entries(a))if(o.includes(c)&&(r===void 0||!o.includes(r))){const e=n.background??n.backgroundColor;if(e!==void 0)return e}}function it(a){const c=a.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(c===null)return;const[r,o,n]=c.slice(1,4).map(Number);return`rgba(${r}, ${o}, ${n}, 0.6)`}function lt(a){const c=[],r=[a];for(;r.length>0;){const o=r.pop();Array.isArray(o)?o.forEach(n=>r.push(n)):"extension"in o?r.push(o.extension):c.push(o)}return c}function gt(a){const c={},r=new CSSStyleSheet;r.replaceSync(a);for(const o of r.cssRules){const{style:n,selectorText:e}=o,{background:m,backgroundColor:g}=n;c[e]={},m.length>0&&(c[e].background=m),g.length>0&&(c[e].backgroundColor=g)}return c}function dt(a){a.light!==void 0&&(i().customThemes.light=a.light),a.dark!==void 0&&(i().customThemes.dark=a.dark),typeof u.MarkEdit.editorView=="object"&&x(u.MarkEdit.editorView)}const f=window,i=()=>f.__markeditTheming__,A=matchMedia("(prefers-color-scheme: dark)");typeof i()!="object"&&mt();function mt(){f.__markeditTheming__={styleSheet:nt(rt),configurator:new Q.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},u.MarkEdit.addExtension(i().configurator.of([])),u.MarkEdit.onEditorReady(c=>x(c));const a=()=>setTimeout(()=>x(u.MarkEdit.editorView),15);A.addEventListener("change",a),i().mainThemeName=f.config.theme,Object.defineProperty(f.config,"theme",{get(){return i().mainThemeName},set(c){i().mainThemeName=c,a()}})}function x(a){const c=A.matches,r=c?i().customThemes.dark:i().customThemes.light,o=et(c,r?.extension),n=ot(c,r?.colors);a.dispatch({effects:i().configurator.reconfigure(o??[])});const[e,m]=st(o),g=o===void 0;i().styleSheet.disabled=g,ut(a,c,g,e,m,n)}function ut(a,c,r,o,n,e){const m=v(o,".cm-activeLine",".cm-activeLineGutter"),g=v(o,s.selectionBackground),D=v(o,s.matchingBracket),S=getComputedStyle(a.contentDOM).color,w=e?.visibleSpace??it(S),K=P(n,t.tags.heading)!==void 0,U=P(n,t.tags.processingInstruction),W=[[s.activeIndicator,m,"background"],[s.matchingBracket,D,"background"],[s.lineGutter,S,"color"],[s.foldGutter,w,"color"],[s.visibleSpace,w,"color"],[s.accentColor,e?.accentColor,"color"],[s.syntaxMarker,U??e?.syntaxMarker,"color"]],z=Array.from(document.querySelectorAll("style")),h=c?i().darkOriginalRules:i().lightOriginalRules;for(const F of z){const y=F.sheet?.cssRules;if(y!==void 0)for(let C=0;C<y.length;++C){const l=y[C],d=l.selectorText??"";d.includes(".cm-focused")&&d.includes(s.selectionBackground)&&(h.selectionBackground??=l.cssText,r?l.cssText=h.selectionBackground:g!==void 0&&l.style.setProperty("background",g,"important")),K&&(d===".cm-md-header"||d===".cm-md-header:not(.cm-md-quote)")&&(h.markdownHeader??=l.cssText,r?l.cssText=h.markdownHeader:l.style.removeProperty("color"));for(const[J,N,E]of W)d===J&&(N===void 0?l.style.removeProperty(E):(l.style.setProperty(E,N,"important"),(d===s.matchingBracket||d===s.activeIndicator)&&l.style.setProperty("box-shadow","unset","important")));d===s.emphasisElement&&(e?.subtleEmphasis??!0?l.style.setProperty("color","inherit","important"):l.style.removeProperty("color"))}}}const ht="#e5c07b",L="#e06c75",ft="#56b6c2",pt="#ffffff",p="#abb2bf",T="#7d8799",kt="#61afef",bt="#98c379",_="#d19a66",yt="#c678dd",Ct="#21252b",$="#2c313a",q="#282c34",B="#353a42",vt="#3E4451",G="#528bff",Bt=R.EditorView.theme({"&":{color:p,backgroundColor:q},".cm-content":{caretColor:G},".cm-cursor, .cm-dropCursor":{borderLeftColor:G},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:vt},".cm-panels":{backgroundColor:Ct,color:p},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:q,color:T,border:"none"},".cm-activeLineGutter":{backgroundColor:$},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:B},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:B,borderBottomColor:B},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:$,color:p}}},{dark:!0}),xt=k.HighlightStyle.define([{tag:t.tags.keyword,color:yt},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:L},{tag:[t.tags.function(t.tags.variableName),t.tags.labelName],color:kt},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:_},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:p},{tag:[t.tags.typeName,t.tags.className,t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:ht},{tag:[t.tags.operator,t.tags.operatorKeyword,t.tags.url,t.tags.escape,t.tags.regexp,t.tags.link,t.tags.special(t.tags.string)],color:ft},{tag:[t.tags.meta,t.tags.comment],color:T},{tag:t.tags.strong,fontWeight:"bold"},{tag:t.tags.emphasis,fontStyle:"italic"},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.link,color:T,textDecoration:"underline"},{tag:t.tags.heading,fontWeight:"bold",color:L},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:_},{tag:[t.tags.processingInstruction,t.tags.string,t.tags.inserted],color:bt},{tag:t.tags.invalid,color:pt}]),Tt=[Bt,k.syntaxHighlighting(xt)];dt({dark:{extension:Tt}});
